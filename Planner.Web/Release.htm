<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8">
	<title>Release</title>
	<meta name="description" content="">
	<meta name="author" content="">
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
  ================================================== -->
	<link rel="stylesheet" href="stylesheets/base.css">
	<link rel="stylesheet" href="stylesheets/skeleton.css">
	<link rel="stylesheet" href="stylesheets/layout.css">
    <link rel="stylesheet" href="stylesheets/tables.css">

	<!-- Favicons
	================================================== -->
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

    <script type="text/javascript" src="Scripts/jquery-1.7.1.min.js"></script>
    <script type="text/javascript" src="Scripts/jquery.dateFormat-1.0.js"></script>
        
    <script type="text/javascript" src="javascripts/Mixin.js"></script>
    <script type="text/javascript" src="javascripts/release.js"></script>
    <script type="text/javascript" src="javascripts/ajax.js"></script>
    <script type="text/javascript" src="javascripts/Roles.js"></script>
    <script type="text/javascript" src="javascripts/UseCases.js"></script>

    <script type="text/javascript" src="Scripts/knockout-2.0.0.js"></script>
    <script type="text/javascript" src="Scripts/highcharts.js"></script>
</head>
<body>
<!-- Primary Page Layout
	================================================== -->

	<!-- Delete everything in this .container and get started on your own site! -->

	<div class="container">
		<header class="sixteen columns">
            <div id="releasetitle" class="eight columns alpha">
                <h1 data-bind="text: title"></h1>
            </div>
            <div id="releaseperiod" class="eight columns omega">
                <h2><data data-bind="text: DateFormatter.formatJsDate(startDate, 'dd/MM/yyyy')"></data> - <data data-bind="text: DateFormatter.formatJsDate(endDate, 'dd/MM/yyyy')"></data></h2>
            </div>
        </header>
        <section id="overview" class="sixteen columns">
            <div id="phases" class="eight columns alpha">
                <ul data-bind="foreach: phases">
                    <li class="price"><h5 data-bind="text: toString()"></h5></li>
                </ul>
                <!--<h4 class="price">Scope final 28 feb</h4>
                <h4 class="price">Development 1 mar - 15 may</h4>
                <h4 class="price">UAT 20 may - 3 jun</h4>
                <h4 class="price">GoLive 16 jun</h4>-->
                <div id="chart-hours"></div>
            </div>
            <div id="remaininghours" class="eight columns omega">
                <div class="eight columns omega">
                    <div id="pie-pbis"></div>
                    <!--<h5>Technical design: <data data-bind="text: PBI.remaininghours()"></data> 16 hrs needed, 40 hrs available, 10 hrs used</h5>
                    <h5>Development: <data data-bind="text: PBI.remaininghours()"></data> 140 hrs needed, 200 hrs available, 20 hrs used</h5>
                    <h5>Documentation: <data data-bind="text: PBI.remaininghours()"></data> 20 hrs needed, 10 hrs available, 40 hrs used</h5>-->
                </div>
            </div>
        </section>

        <section class="sixteen columns">
            <div id="tabSection" class="sixteen columns alpha">
                <ul class="tabs" data-bind="foreach: $.grep(sets, function(n,I) { return n.groupedBy == 'project';})">
                <!-- Give href an ID value of corresponding "tabs-content" <li>'s -->
                  <li data-bind="attr: {tag: label}"><a data-bind="attr: {href: link}"><data data-bind="text: label"></data></a></li>
                </ul>
                <!--<div class="row">-->
                <!-- Standard <ul> with class of "tabs-content" -->
                <ul id="tabsContent" class="tabs-content" data-bind="foreach: $.grep(sets, function(n,I) { return n.groupedBy == 'project';}) ">
                  <!-- Give ID that matches HREF of above anchors -->
                  <li data-bind="attr: {id: label}">
                    <table class="zebra-striped condensed">
                    <!--TODO: Per Activity grouping, same as bug and change as container for tasks-->
                        <thead>
                            <tr>
                                <th>Feature Id</th>
                                <th>Feature Title</th>
                                <th>Remaining Hours</th>
                                <th>Contact Person</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <td colspan="11"><strong>Total Hours Remaining (excl. Descoped and from Ready for System Test on)<strong></td>
                                <td aria-live="polite"><strong><data data-bind="text: totalHours"></data></strong> </td>
                            </tr>
                        </tfoot>
                        <!-- @businessId, @contactPerson, @estimatedHours, @hoursWorked, @priority, @project, @remainingHours, @title, @state-->
                        <tbody data-bind="foreach: items" id="taskstablebody">
                            <tr aria-live="polite">
                                <td data-bind="text: businessId"></td>
                                <td data-bind="text: title"></td>
                                <td data-bind="text: remainingHours"></td>
                                <td data-bind="text: contactPerson"></td>
                                <td data-bind="text: state"></td>
                            </tr>
                        </tbody>
                    </table>
                </li>
            </ul>
            </div>
        </section>
	</div><!-- container -->
    <script type="text/javascript">
        // see http://www.highcharts.com/ref/#plotOptions-pie-dataLabels--formatter
        var pieChartOptions = {
            allowPointSelect: true,
            cursor: 'pointer',
            size: "40%",
            dataLabels: {
                enabled: true,
                connectorPadding: 5,
                style: {
                    fontSize: 8
                },
                connectorWidth: 0.5,
                formatter: function () {
//                    var label = "<b>" + this.point.name + "</b> : " + this.percentage;
//                    return label;
                    return "<b>" + this.point.name + "</b>:" + this.y;
                }
            }
        };

        function showHoursChart(projectNames, remainingHours, availableHours, balanceHours) {
            var chart = new Highcharts.Chart({
                chart: {
                    renderTo: 'chart-hours',
                    defaultSeriesType: 'column'
                },
                title: {
                    text: 'Overview hours'
                },
                xAxis: {
                    categories: projectNames
                },
                tooltip: {
                    formatter: function () {
                        return '' + this.series.name + ': ' + this.y + '';
                    }
                },
                credits: {
                    enabled: false
                },
                series: [{
                    name: 'Hours Available',
                    data: availableHours
                },
                {
                    name: 'Workload',
                    data: remainingHours
                },
                {
                    name: 'Balance',
                    data: balanceHours
                }]
            })
        }

        function showStatusChart(statusdata) {
            var chartOptions = {};
            chartOptions.chart = {
                // set to div id
                renderTo: "pie-pbis",
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            };
            chartOptions.title = { text: "Status Features" };
            chartOptions.series = [{
                type: "pie",
                name: "amount",
                data: statusdata
            }];
            chartOptions.plotOptions = {
                pie: pieChartOptions
            };
            var chart2 = new Highcharts.Chart(chartOptions);
        }
        

        $(document).ready(function () {
            var ajax = new Ajax();

            //Release.extend(RMoveItem);

            var displayReleaseStatus = new UDisplayReleaseStatus();
            ajax.load(displayReleaseStatus.execute);

            //$("#tabSection > ul > li > a").first().addClass("active");
            //$(".tabs-content > li").first().addClass("active");

            // add toggle function for tabs
            $("#tabSection > ul").on("click", "li > a", function (event) {
                // set active tab and content to inactive
                $(".active").removeClass("active");
                // set clicked tab to active
                $(this).addClass("active");

                // set content for clicked tab to active
                var tag = $(this).parent().attr('tag');
                $("#tabsContent").find("#" + tag).addClass("active");
            });

        });
    </script>

</body>
</html>
